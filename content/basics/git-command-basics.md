---
title: "Git の基本コマンド"
date: 2022-03-16T07:42:16+09:00
weight: 3
---

## Git の基本コマンド
Git の操作方法は GUI と CUI に分けられます。  
Git の GUI を利用すれば、マウスを使って画面上のアイコンやウィンドウを使用すると簡単に Git を操作することができます。  
しかし、以下の理由から CUI で学習をすることをお勧めします。  
- つまづいたとき、実行したコマンドと表示されたエラーを元にネットで検索をすることで原因が特定しやすい
- Git に関する記事は GUI よりも CUI の方が圧倒的に多い
- 実行した内容がログとして残るため、自分がどのような操作をしたのかという証跡が残る

そのため、ある程度慣れたのであれば GUI で Git を操作してもよいと思いますが、この教育コンテンツでは CUI（コマンド）で操作を行います。  
ここからは基本的な Git コマンドを紹介します。実際に Git コマンドを実行しながら確認をしていきましょう。  

Git コマンドを実行するにはまずローカル（皆さんのPC内）に Git で管理されているディレクトリを用意する必要があります。
Git で管理されているディレクトリを作成する方法は `git init` と `git clone` の２種類があります。  
それぞれの違いを確認していきましょう。

---
### 既存ディレクトリを Git 管理する
`git init` コマンドにより既に作成済みのディレクトリ（フォルダ）をローカルの Git リポジトリにすることができます。  
同コマンドを実行すると、指定したディレクトリに **「.git」** ディレクトリが作成されます。  
この「.git」ディレクトリが配下にあるディレクトリは Git リポジトリとして扱われます。  
```
git init [Gitリポジトリにしたいディレクトリのパス（省略可）]
```
[Gitリポジトリにしたいディレクトリのパス]は省略することもでき、その場合はカレントディレクトリ（cdコマンド等で移動した現在のディレクトリ）が Git リポジトリとなります。

**DEMO**
今回はデスクトップ上に git-tutorial ディレクトリを作成して、作成した同ディレクトリを Git リポジトリにしてみましょう。
```
cd /Users/UserName/Desktop
mkdir git-tutorial
git init git-tutorial
```
コマンド実行時に `Initialized empty Git repository in /Users/UserName/Desktop/git-tutorial/.git/`と表示されれば成功です。
※上記のメッセージのうち、UserNameにはOSにログインしているユーザー名が表示されます。  
git-tutorial フォルダを Git リポジトリにすることができたら、git-tutorial フォルダの配下に「.git」ディレクトリがあることを確認しましょう。
```
cd git-tutorial
ls -al
```

---
### リモートリポジトリをクローンする
GitHubなどに存在するリモートリポジトリをローカルにクローン（コピー）して開発を始めることもできます。  
実際の開発ではチームで１つのリポジトリを共有して利用するため、チームメンバーのひとりがリモートリポジトリを作成して、  
残りのメンバーはそのリポジトリをクローンするところから開発が始まることが一般的です。  
これを実現するのが `git clone` コマンドで、コマンドの後ろにはクローンしたいリポジトリのURLを指定します。
```
git clone [リモートリポジトリのURL] [クローン先のディレクトリのパス（省略可）]
```
[クローン先のディレクトリのパス（省略可）]は省略することもでき、  
その場合はカレントディレクトリ（cdコマンド等で移動した現在のディレクトリ）の配下にクローンした Git リポジトリが生成されます。

**DEMO**
今回は GitHub 上にある [git_tutorial](https://github.com/a-nakamura1015/git_tutorial.git) リポジトリをローカルのデスクトップにクローンしてみましょう。
```
cd /Users/UserName/Desktop
git clone https://github.com/a-nakamura1015/git_tutorial.git
```
コマンド実行御にデスクトップ上に git_tutorial リポジトリがあることを確認してみましょう。

---
### 既存ディレクトリにリモートリポジトリを追加する
ローカルのリポジトリとリモートリポジトリを紐づけるコマンドもあるので紹介します。   
 `git remote add`コマンドでリモートリポジトリの名前（**origin**）とリモートリポジトリのURLを設定することで実現できます。  
```
git remote add [リモートリポジトリの名前] [リモートリポジトリのURL]
```
リモートリポジトリにはデフォルトで**origin**という名前がついているので、この名前とリモートリポジトリのURLを紐付けるのが一般的です。  
また、ローカルリポジトリが現在どのリモートリポジトリと紐づいているかは以下のコマンドで確認をすることができます。
```
git remote -v
```
一方で一度紐づけたリモートリポジトリとの紐付けを解除することもできます。
```
git remote rm [リモートリポジトリの名前]
```

**DEMO**
今回はデスクトップ上に remote ディレクトリを作成して、[git_tutorial](https://github.com/a-nakamura1015/git_tutorial.git) リポジトリをリモートリポジトリとなるように設定してみましょう。
まずは以下のコマンドでデスクトップ上に remote ディレクトリを作成して、remote ディレクトリをカレントディレクトリにしましょう。
```
cd /Users/UserName/Desktop
mkdir remote
cd remote
```
続いて、以下のコマンドでリモートリポジトリを紐付けましょう。
```
git remote add origin https://github.com/a-nakamura1015/git_tutorial.git
```
以下のコマンドで火もづいているリモートリポジトリを確認してみましょう。
```
git remote -v
```
以下のような結果が表示されれば成功です。
```
origin	/Users/UserName/Desktop/remote/ (fetch)
origin	/Users/UserName/Desktop/remote/ (push)
```
最後にリモートリポジトリとの紐付けを解除してみましょう。  
先ほどリモートリポジトリのURLを設定した際に指定したリモートリポジトリの名前は **origin** なので以下のコマンドを実行しましょう。
```
git remote rm origin
```
これでリモートリポジトリの紐付けがなくなりました。試しに`git remote -v`を実行してみても結果は何も表示されません。

ここまではディレクトリを Git リポジトリにするコマンドを紹介してきました。  
ここからは本命のファイルの変更履歴を残す・確認するコマンドを紹介しますが、
「既存ディレクトリを Git 管理する」で作成した git-tutorial ディレクトリでコマンドの動作を確認していきます。  
以下のコマンドを実行した上で次に進みましょう。
```
cd /Users/UserName/Desktop/git-tutorial
```

---
### 現在のステータスを確認する
まずはGitリポジトリ内の状態を確認する `git status` コマンドを紹介します。  
後ほどファイルの状態をご紹介しますが、編集したファイルがどのような状態であるかを確認することができるコマンドです。
```
git status
```
git-tutorial ディレクトリでこのコマンドを実行すると、以下の内容が表示されます。
```
On branch master

No commits yet

nothing to commit (create/copy files and use "git add" to track)
```

`On branch master` はカレントブランチが master であることを意味します。（ブランチは応用編で解説します。）
`No commits yet`はコミットがまだないことを意味します。  
コミットは Git が管理しているリポジトリ内のログに変更履歴を残す操作のことを指します。  
まだコミットをしていないので画面上には`No commits yet`と表示されています。  

この後いくつかの Git コマンドを実行してステータスを変えていくので、その際にこのコマンドで状態を確認していきましょう。

---
### ファイルの状態の種類
ファイルの状態は３種類があり、ステージ済 → 修正済 → コミット済の順に推移していきます。
ファイルの変更履歴は Git で管理されていますが、ファイルを編集することで自動的に Git に残るわけではありません。  
この３種類の状態を経て、Git に変更履歴を残すことができるのです。

1. ステージ済：ファイルが編集された状態のこと。（`git add` コマンドを実行する前の状態）
1. 修正済：ファイルがコミットの対象になっている状態のこと。（`git commit` コマンドを実行する前の状態）
1. コミット済：Git にファイルの変更履歴が残っている状態のこと。

---
### 変更内容をインデックスに追加する
新規追加・変更したファイルは `git add` コマンドでステージ済の状態にすることができます。  
コマンドの後ろにはステージ済にしたいファイルのパスを指定します。
```
git add [編集したファイルのパス]
```

**DEMO**
今回は sample.txt を新規で作成して、同ファイルをステージ済の状態にしてみましょう。
①ファイルを新規で作成してみよう
まずは以下のコマンドで sample.txt を作成します。  
```
touch sample.txt
```
続いて、作成したファイルに hello を追記します。
```
echo hello > sample.txt
```
`cat` コマンドで sample.txt に hello が追記できているかを確認してみましょう。
```
cat sample.txt
```
ここで一旦ステータスを確認してみましょう。
```
git status
```
`git status`コマンドを実行すると以下の結果が表示されます。
```
On branch master

No commits yet

Untracked files:
  (use "git add <file>..." to include in what will be committed)
	sample.txt

nothing added to commit but untracked files present (use "git add" to track)
```
着目する点は `Untracked files` です。  
これはまだ Git の管理下に置かれていないファイルがあることを意味します。  
 `Untracked files`の後ろに sample.txt があるので、このファイルがまだ Git の管理下に置かれていないということです。  
Git の管理下に置かれるようにするには `git add` コマンドを実行する必要があります。

②ファイルのステータスを修正済にする
それでは、`git add` コマンドを実行してみましょう。
```
git add sample.txt
```
`git add` コマンドを実行すると、以下の内容が表示されます。
```
On branch master

No commits yet

Changes to be committed:
  (use "git rm --cached <file>..." to unstage)
	new file:   sample.txt
```
`git add` コマンドの実行前は `Untracked files` でしたが、実行後は `Changes to be committed` に変わりました。
これはファイルのステータスが修正済に変わり、コミットの対象になっていることを意味します。
今回は新しいファイルを Git に追加しようとしているため `new file:   sample.txt`と表示されています。

---
### 変更内容をコミットする
先ほどは変更内容をインデックスに追加する（ステータスをステージ済 → 修正済にする）流れを確認しました。  
変更内容をインデックスに追加されていると、その変更内容を Git の履歴に残すことができるようになります。  
この Git の履歴に残す操作を `コミット` といいますが、コミットは以下のコマンドで実行することができます。
```
git commit
```
また、コミットの際に任意のメッセージを残すことができます。  
以下のコマンドのように、コマンドの後ろにオプション（`-m`）を指定して、その後に登録したいメッセージを入力します。  
（注意：メッセージはクォーテーションで囲う必要があります。）

実際の開発プロジェクトでは「このコミットでどのような対応を行なったか」をメッセージに残すことになります。  
なぜなら、大量のコミットのログの中から特定のコミットを探す作業を用意にすることができ、
またチームメンバーにもどのような対応をしたのかを共有することもできるからです。
```
git commit -m "message"
```

**DEMO**
今回は先ほど修正済（`git add` コマンドを実施済）となった sample.txt の新規追加する内容を Git の変更履歴に登録しましょう。  
コミットのメッセージには`first commit` と入力しましょう。（今回のメッセージは英語でしたが、日本語を入力することも可能です。）
```
git commit -m "first commit"
```
コマンドを実行すると以下のメッセージが画面に表示されます。
```
[master (root-commit) 5c670db] first commit
 1 file changed, 1 insertion(+)
 create mode 100644 sample.txt
```
それでは、再度ステータスを確認してみましょう。
```
git status
```
コマンドを実行すると以下のメッセージが画面に表示されます。
```
On branch master
nothing to commit, working tree clean
```
コミットを行なったことにより修正済のファイルがコミット済となったため、`nothing to commit, working tree clean` と表示されます。

---
### コミットログを確認する
Git はコミットした履歴（コミットログ）を以下のコマンドで確認することができます。  
```
git log
```
コマンドを実行すると以下のようなログが表示されます。
```
commit 5c670db6fc4a8d109a5e2724c421cd8105c2598f (HEAD -> master)
Author: corgi9n <arapon@gmail.com>
Date:   Fri Mar 11 03:44:55 2022 +0900

    first commit
```
`commit 5c670db6fc4a8d109a5e2724c421cd8105c2598f (HEAD -> master)`のうち、
`5c670db6fc4a8d109a5e2724c421cd8105c2598f` はコミットのハッシュ値で、
` (HEAD -> master)`は HEAD の内容を master ブランチに履歴を残したということを意味します。（ブランチについては応用編で解説します。）
`Author`は Git のコミットを残した Git アカウントが表示され、  
`Date`は Git のコミットを残した日時が表示されます。  
さらに下にはコミットの際に残したメッセージが表示されます。

メモ：もし、`git log` コマンドを実行した後、表示されたログの下に `:` が表示されている場合は、
続けてコマンドを実行することができません。  
この場合は `q` を入力して Enter キーを押すことで再度コマンドが実行できるようになります。

---
### 変更内容をリモートリポジトリに反映する
先ほどはコミットを完了して、ファイルの変更内容を無事コミットログに残すことができました。  
これでやりたいことが終わったように感じますが、まだやらなければならないことが残っています。  
チーム開発している場合はリモートリポジトリでソースコードを共有しているため、  
**ファイルを編集した場合はリモートリポジトリにアップロードして、チームメンバーと共有できるようにする** 必要があります。  

変更内容（コミットログ）をリモートリポジトリにアップロードするには、  
`git push` コマンドを実行します。
```
git push origin [リモートリポジトリの名前] [リモートリポジトリのブランチ名]
```
**DEMO**
今回は以下のコマンドを実行して、リモートリポジトリの main ブランチにアップロードをしてみましょう。
```
git push origin main
```
コマンドを実行するとパスワードの入力を求められます。  
これは GitHub アカウントに対して2段階認証を設定したため GitHub アカウントのパスワードを求められています。  
GitHub アカウントのパスワードを入力して Enter キーを押しましょう。  
(入力したパスワードは目視で確認ができないため、誤入力に気をつけましょう。)

無事コマンドを完了できたら、GitHub上でアップロードされたファイルを確認してみましょう。

---
### リモートリポジトリから最新の履歴を取得する
先ほどは `git push` コマンドでリモートリポジトリに変更内容を反映いたしました。  
リモートリポジトリが更新されると、他のメンバーはリモートリポジトリから最新のソースコードをダウンロードすることになります。  
(もちろん、他のメンバーがリモートリポジトリを更新したら、あなたも最新のソースコードをダウンロードすることになります。)
リモートリポジトリからソースコードをダウンロードする場合は、`git pull` コマンドを実行します。
```
git pull [リモートリポジトリの名前] [リモートリポジトリのブランチ名]
```
**DEMO**
今回はリモートリポジトリ上に main ブランチしかないため、以下のコマンドを実行しましょう。  
ただ今回はローカルリポジトリの内容をアップロードしたばかりのため、`git pull` コマンドを実行してもローカルリポジトリに変化はありません。
```
git pull origin main
```
`git pull` コマンドを実行することでローカルリポジトリが変わる内容は、  
応用編で登場しますので楽しみにしてください！
